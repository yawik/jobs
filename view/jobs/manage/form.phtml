<?php
/**
 * YAWIK
 *
 * @filesource
 * @copyright (c) 2013-2104 Cross Solution (http://cross-solution.de)
 * @license   MIT
 */
// Tweak navigation
// @TODO move this navigation-processing to the controller
//$navigation = $this->navigation('Core/Navigation')->getContainer();
//$navigation->findOneBy('route', 'lang/jobs')->setActive(true);
//$subPage = $navigation->findOneBy('id', 'Jobs/' . $this->action);
//$subPage->setActive(true);

$this->headscript()->appendFile($this->basepath('Core/js/core.forms.js'));
?>
<h1>
<?php
    if ('new' == $this->action):
            echo $this->translate('Publish a job');
    else:
            echo sprintf($this->translate('Edit the job %s'),'<i>'.$this->title.'</i>');
    endif;
?>
</h1>

<?php
if ($this->page == 2)
{
    $viewLink = $this->url(
            'lang/jobs/view',
                array(
                ),
                array(
                    'query' => array(
                       'id' => $this->job->id
                    )
                )
    );
    echo '<iframe src="' . $viewLink . '" name="preview" style="width:100%; height:800px;"></iframe>';
    echo '<h3>' . $this->translate('summary') . '</h3>';

    echo $this->summary;
}
?>


<?php echo $this->formContainer($this->form,'form-horizontal'); ?>

<?php
if ($page == 2):
?>
    <div id="job_incomplete" class="alert alert-warning ">
        <?php
        echo $this->translate('Ihre Eingaben sind unvollständig. Um die Bewerbung absenden zu können, müssen Sie Ihre Kontaktdaten angeben und die Datenschutzbestimmungen akzeptieren. Sie können jederzeit die Vorschau über Ihre hinterlegten Daten einsehen bzw. den Bewerbungsprozess abbrechen.');
        ?>
        <span id="job_errormessages">
<?php
if (isset($this->valid) && $this->valid == false && !empty($this->errorMessage)) {
    echo ($this->errorMessage);
}
?>
        </span>
    </div>
<?php
endif;
?>

<div id="locationForm-buttons" class="buttons-bar form-group">
    <div class="col-md-12">
<?php
    switch($page):
    case "0":
        echo '<a href="' . $this->pageLinkNext . '" class="btn btn-primary">' . $this->translate('Next to enter the job') . '</a>' . PHP_EOL;
        break;
    case "1":
        echo '<a href="' . $this->pageLinkPrevious . '" class="btn btn-primary">' . $this->translate('&lt; Previous') . '</a>' . PHP_EOL;
        echo '<a href="' . $this->pageLinkNext . '" class="btn btn-primary">' . $this->translate('Next to preview the job') . '</a>' . PHP_EOL;
        break;
    case "2":
        echo '<a href="' . $this->pageLinkPrevious . '" class="btn btn-primary">' . $this->translate('&lt; Previous') . '</a>' . PHP_EOL;
        echo '<a id="finalize_jobentry" style="display:none;" href="' . $this->basepath('/jobs/finalize?id=' . $this->job->id) . '" class="btn btn-primary">' . $this->translate('Next to publish the job') . '</a>' . PHP_EOL;
    default:

    endswitch;
?>
    </div>
</div>