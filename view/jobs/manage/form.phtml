<?php
/**
 * YAWIK
 *
 * @filesource
 * @copyright (c) 2013-2104 Cross Solution (http://cross-solution.de)
 * @license   MIT
 */

$this->headscript()->appendFile($this->basepath('Core/js/core.forms.js'));
?>
<h1>
<?php
    if ('new' == $this->action):
            echo $this->translate('Publish a job');
    else:
            echo sprintf($this->translate('Edit the job %s'),'<i>'.$this->title.'</i>');
    endif;
?>
</h1>
<h3><?php echo $this->translate("Preview of your job posting"); ?></h3>
<?php
if ($this->page == 2):

    $viewLink = $this->url(
            'lang/jobs/view',
                array(
                ),
                array(
                    'query' => array(
                       'id' => $this->job->id
                    )
                )
    );
?>
    <div class="row">
    <div class="col-md-8">
        <div class="panel panel-default">
            <div class="panel-body">
                <iframe style="width:100%; height:800px;" src="<?php echo $viewLink ?>"></iframe>
            </div>
        </div>
    </div>
    <div class="col-md-4">
        <div class="alert alert-info">
        <?php echo sprintf($this->translate('Please check the preview of your job position. Click %s to open the preview in a new window'),
                           '<a target="_blank" href="'.$viewLink.'">'.$this->translate("here").'</a>'); ?>
        </div>
    </div>
    </div>
    <h3><?php echo $this->translate('Summary') ?></h3>

    <?php echo $this->summary?>
<?php endif; ?>

<?php echo $this->formContainer($this->form,'form-horizontal'); ?>

<?php if ($page == 2): ?>
    <div id="job_incomplete" class="alert alert-warning ">
    <?php echo $this->translate('Your job position is incomplete. You have to set a job title, the location of the job and accept terms and conditions to be able to publish the job.'); ?>
    <span id="job_errormessages">
    <?php if (isset($this->valid) && $this->valid == false && !empty($this->errorMessage)) echo ($this->errorMessage); ?>
    </span>
    </div>
<?php endif; ?>

<div id="locationForm-buttons" class="buttons-bar form-group">
    <div class="col-md-12">
<?php
    switch($page):
    case "0":
        echo '<a href="' . $this->pageLinkNext . '" class="btn btn-primary">' . $this->translate('Next to enter the job') . '</a>' . PHP_EOL;
        break;
    case "1":
        echo '<a href="' . $this->pageLinkPrevious . '" class="btn btn-primary">' . $this->translate('&lt; Previous') . '</a>' . PHP_EOL;
        echo '<a href="' . $this->pageLinkNext . '" class="btn btn-primary">' . $this->translate('Next to preview the job') . '</a>' . PHP_EOL;
        break;
    case "2":
        echo '<a href="' . $this->pageLinkPrevious . '" class="btn btn-primary">' . $this->translate('&lt; Previous') . '</a>' . PHP_EOL;
        echo '<a id="finalize_jobentry" style="display:none;" href="' . $this->basepath('/jobs/finalize?id=' . $this->job->id) . '" class="btn btn-primary">' . $this->translate('Next to publish the job') . '</a>' . PHP_EOL;
    default:

    endswitch;
?>
    </div>
</div>